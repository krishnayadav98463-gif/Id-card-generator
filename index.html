<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetID Pro | Digital Dog ID</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap');

        :root { --primary: #3b82f6; --bg: #0f172a; }

        body {
            margin: 0; padding: 20px; font-family: 'Montserrat', sans-serif;
            background: var(--bg); color: white;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
        }

        .container {
            background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1); padding: 25px; border-radius: 20px;
            width: 100%; max-width: 380px; box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        h1 { text-align: center; font-size: 22px; font-weight: 800; color: #60a5fa; margin-bottom: 20px; }

        .input-group { margin-bottom: 12px; }
        label { display: block; font-size: 11px; font-weight: 600; color: #94a3b8; margin-bottom: 4px; text-transform: uppercase; }
        
        input, select {
            width: 100%; padding: 12px; background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: white; outline: none; box-sizing: border-box;
        }

        .btn {
            width: 100%; padding: 14px; margin-top: 15px; border-radius: 12px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white; border: none; font-weight: 700; cursor: pointer; transition: 0.3s;
        }

        /* --- FIXED ALIGNMENT (IMAGE KI TARAH) --- */
        #output-screen { display: none; text-align: center; margin-top: 20px; width: 100%; }
        
        #id-card {
            background: white; color: #1e293b; width: 320px; 
            border-radius: 20px; overflow: hidden; margin: 0 auto;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            display: flex; flex-direction: column; align-items: center;
        }

        .card-header { 
            width: 100%; height: 55px; background: #1e293b; 
            display: flex; align-items: center; justify-content: center; 
            color: white; font-weight: 800; font-size: 20px; letter-spacing: 2px;
        }

        .pet-img-container { margin-top: 25px; position: relative; }

        .pet-img { 
            width: 130px; height: 130px; border-radius: 50%; 
            border: 4px solid #3b82f6; object-fit: cover; 
            background: #cbd5e1;
        }
        
        .card-body { 
            padding: 20px; text-align: center; width: 100%; box-sizing: border-box;
        }

        /* Details Styling (Same as your image) */
        .name-row { font-size: 20px; font-weight: 800; color: #3b82f6; margin-bottom: 10px; }
        .age-status-row { font-size: 16px; font-weight: 600; color: #475569; margin-bottom: 8px; display: flex; justify-content: center; align-items: center; gap: 8px; }
        .address-row { font-size: 14px; color: #64748b; line-height: 1.4; padding: 0 10px; }

        .status-dot { height: 12px; width: 12px; border-radius: 50%; display: inline-block; }

        #qr-target { 
            margin: 15px 0 25px 0; 
            display: flex; justify-content: center;
        }

        /* Mode Selection */
        .choice-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .choice-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); text-align: center; }
    </style>
</head>
<body>

    <div class="container" id="form-screen">
        <h1>PET ID PRO</h1>
        <div class="input-group">
            <label>Upload Photo</label>
            <input type="file" id="imgInput" accept="image/*">
        </div>
        <div class="input-group">
            <label>Dog Name</label>
            <input type="text" id="petName" placeholder="e.g. CARAMEL">
        </div>
        <div class="input-group">
            <label>Age</label>
            <input type="text" id="petAge" placeholder="e.g. 2.6">
        </div>
        <div class="input-group">
            <label>Address</label>
            <input type="text" id="petAddr" placeholder="Street, District">
        </div>
        <div class="input-group">
            <label>Owner (For QR)</label>
            <input type="text" id="ownerName" placeholder="Owner Name">
        </div>
        <div class="input-group">
            <label>Phone (For QR)</label>
            <input type="tel" id="petPhone" placeholder="Mobile">
        </div>
        <div class="input-group">
            <label>Health Status</label>
            <select id="petHealth">
                <option value="green">Vaccinated (Green)</option>
                <option value="black">Disease (Black)</option>
                <option value="blue">Due (Blue)</option>
                <option value="red">Not Vaccinated (Red)</option>
            </select>
        </div>
        <button class="btn" onclick="goToChoice()">NEXT STEP</button>
    </div>

    <div class="container" id="choice-screen" style="display:none">
        <h2 style="text-align:center">CHOOSE FORMAT</h2>
        <div class="choice-grid">
            <div class="choice-card" onclick="finalRender('full')">ü™™ FULL CARD</div>
            <div class="choice-card" onclick="finalRender('qr')">üèÅ ONLY QR</div>
        </div>
        <button class="btn" style="background:#334155" onclick="location.reload()">BACK</button>
    </div>

    <div id="output-screen">
        <div id="id-card"></div>
        <button class="btn" onclick="downloadID()" style="max-width:320px">DOWNLOAD PNG</button>
        <button class="btn" style="background:#334155; max-width:320px" onclick="location.reload()">CREATE NEW</button>
    </div>

    <script>
        let petData = {};

        function goToChoice() {
            petData = {
                name: document.getElementById('petName').value,
                age: document.getElementById('petAge').value,
                addr: document.getElementById('petAddr').value,
                owner: document.getElementById('ownerName').value,
                phone: document.getElementById('petPhone').value,
                health: document.getElementById('petHealth').value,
                img: document.getElementById('imgInput').files[0]
            };
            if(!petData.name || !petData.img) return alert("Photo & Name are required!");
            document.getElementById('form-screen').style.display = "none";
            document.getElementById('choice-screen').style.display = "block";
        }

        function finalRender(type) {
            document.getElementById('choice-screen').style.display = "none";
            const card = document.getElementById('id-card');
            const reader = new FileReader();
            
            reader.onload = function(e) {
                let statusTxt = petData.health === 'green' ? 'Vaccinated' : petData.health === 'black' ? 'Disease' : petData.health === 'blue' ? 'Due' : 'Not Vaccinated';
                
                if(type === 'full') {
                    card.innerHTML = `
                        <div class="card-header">ID CARD</div>
                        <div class="pet-img-container">
                            <img src="${e.target.result}" class="pet-img">
                        </div>
                        <div class="card-body">
                            <div class="name-row">NAME: ${petData.name.toUpperCase()}</div>
                            <div class="age-status-row">
                                AGE: ${petData.age} | <span class="status-dot" style="background:${petData.health}"></span> ${statusTxt}
                            </div>
                            <div class="address-row"><strong>ADDRESS:</strong> ${petData.addr}</div>
                        </div>
                        <div id="qr-target"></div>
                    `;
                } else {
                    card.innerHTML = `
                        <div style="padding:30px; background:white; width:100%; display:flex; flex-direction:column; align-items:center;">
                            <div id="qr-target" style="margin:0"></div>
                            <h2 style="margin:15px 0 5px 0; color:#1e293b">${petData.name.toUpperCase()}</h2>
                            <p style="margin:0; color:#64748b; font-size:14px">SCAN FOR OWNER INFO</p>
                        </div>
                    `;
                }

                new QRCode(document.getElementById('qr-target'), {
                    text: `DOG:${petData.name}\nOWNER:${petData.owner}\nPHONE:${petData.phone}\nSTATUS:${statusTxt}`,
                    width: 140, height: 140
                });

                document.getElementById('output-screen').style.display = "block";
            }
            reader.readAsDataURL(petData.img);
        }

        function downloadID() {
            html2canvas(document.getElementById('id-card'), { scale: 3 }).then(canvas => {
                const a = document.createElement('a');
                a.href = canvas.toDataURL();
                a.download = 'Pet_ID.png';
                a.click();
            });
        }
    </script>
</body>
</html>
